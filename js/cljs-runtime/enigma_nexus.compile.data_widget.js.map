{"version":3,"sources":["enigma_nexus/compile/data_widget.cljs"],"mappings":"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","names":["enigma-nexus.compile.data-widget/continous-number","value*","reagent.core.atom","cljs.core.swap_BANG_","cljs.core/inc","enigma-nexus.compile.data-widget/decompile-from-tree","data","cljs.core/vector?","cljs.core.mapv","item","cljs.core/map?","cljs.core.apply","cljs.core/merge","cljs.core.map","p__73491","vec__73492","cljs.core.nth","key","value","cljs.core/coll?","enigma-nexus.compile.data-widget/compile-to-tree","enigma-nexus.data-widget.skins/cell-text-input","enigma-nexus.data-widget.skins/nested-menu-init","enigma-nexus.compile.demo/figma-table-menu","enigma-nexus.compile.demo/tree-menu-ui-props","enigma-nexus.data-widget.skins/expand-collapse","enigma-nexus.data-widget.skins/to-row","enigma-nexus.data-widget.skins/to-tree","p1__73495#","enigma-nexus.data-widget.skins/map-key","p__73498","vec__73499","enigma-nexus.compile.data-widget/compile-neo-json","cljs.core/random-uuid","enigma-nexus.data-widget.skins/multi-select-menu-init","enigma-nexus.data-widget.skins/single-select-menu-init","dut"],"sourcesContent":["(ns enigma-nexus.compile.data-widget\r\n  (:require\r\n   [reagent.core :as r :refer [with-let]] \r\n   [enigma-nexus.compile.demo :as demo]\r\n   [enigma-nexus.data-widget.skins :as skin]))\r\n\r\n(def continous-number\r\n  (let [value* (r/atom 0)]\r\n    (fn [] (swap! value* inc))))\r\n\r\n(defn decompile-from-tree [data]\r\n  (cond\r\n    (vector? (:data data)) (mapv (fn [item] (decompile-from-tree item)) (:data data))\r\n    (map? (:data data)) (apply merge (map (fn [[key value]] {(decompile-from-tree key) (decompile-from-tree value)}) (:data data)))\r\n    (not (coll? (:data data))) (:data data)))\r\n\r\n\r\n(defn compile-to-tree [data]\r\n  (cond\r\n    (not (coll? data)) {:id (continous-number)\r\n                        :indicators #{:expanded}\r\n                        :data (str data)\r\n                        :component [skin/cell-text-input]} ; we need to be able w/o compilatation build a table widget that will present scalar\r\n\r\n    (vector? data) {:id (continous-number)\r\n                    :indicators #{:tree}\r\n                    :control-component [(skin/nested-menu-init demo/figma-table-menu demo/tree-menu-ui-props)]\r\n                    :component [skin/expand-collapse skin/to-row skin/to-tree] \r\n                    :index-component []\r\n                    :data (mapv #(compile-to-tree %) data)}\r\n\r\n    (map? data) {:id (continous-number)\r\n                 :indicators #{:tree}\r\n                 :control-component [(skin/nested-menu-init demo/figma-table-menu demo/tree-menu-ui-props)]\r\n                 :component [skin/expand-collapse skin/to-row skin/to-tree]\r\n                 :index-component [skin/map-key] \r\n                 :data (apply merge (map (fn [[key item]] {{:data (str key)\r\n                                                            :id (continous-number)}\r\n                                                           (compile-to-tree item)}) data))}))\r\n\r\n\r\n\r\n\r\n\r\n; data -> [schema] -> compile -> visual data -> data_widget -> UI -> decompile\r\n\r\n\r\n; (defn compile-to-figma-table [data]\r\n;   (cond\r\n;     (not (coll? data)) {:id (str (random-uuid))\r\n;                         :indicators #{:expanded}\r\n;                         :type :scalar\r\n;                         :data (str data)\r\n;                         :component [(skin/multi-select-menu-init [\"PTK\" \"JER\"])]}\r\n\r\n;     (vector? data) {:id (str (random-uuid))\r\n;                     :type :vector\r\n;                     :indicators #{:expanded (if (every? vector? data) :table)}\r\n;                     :component []\r\n;                     :data (vec (map-indexed (fn [index item] (compile-to-figma-table item)) data))}\r\n\r\n;     (map? data) {:id (str (random-uuid))\r\n;                  :indicators #{:expanded}\r\n;                  :type :map\r\n;                  :component []\r\n;                  :data (apply merge (map (fn [[key item]] {{:indicators #{:expanded}\r\n;                                                             :type :map-key\r\n;                                                             :data (str key)\r\n;                                                             :id (str (random-uuid))\r\n;                                                             :component [skin/map-key]}\r\n;                                                            (compile-to-figma-table item)}) data))}))\r\n\r\n\r\n; (def plus-kebab [[icons/kebab]\r\n;                  [[icons/plus]\r\n;                   [{:text \"Add Row 1\"\r\n;                     :action #(js/alert \"Row 1\")}]\r\n;                   [{:text \"Add Row 2\"\r\n;                     :action #(js/alert \"Row 2\")}]]\r\n                 \r\n;                  [{:text [icons/trash]\r\n;                    :action (fn [root* path]\r\n;                              ;; TODO fix for maps (currently can only delete items from vectors)\r\n;                              (swap! root* (fn [root]\r\n;                                             (let [path-one-before (pop path)\r\n;                                                   item-to-delete (get-in root path)]\r\n;                                               (update-in root path-one-before (fn [coll] (vec (remove #(= % item-to-delete) coll))))))))}]\r\n;                  [[icons/duplicate] [{:text \"duplicate\"}]]])\r\n\r\n\r\n(defn compile-neo-json [data]\r\n  {:id (str (random-uuid))\r\n   :indicators #{:expanded}\r\n   :component []\r\n   :data {{:id (continous-number)\r\n           :indicators #{}\r\n           :data :role\r\n           :component [skin/map-key]}\r\n          {:id (continous-number)\r\n           :indicators #{}\r\n           :data (:role data)\r\n           :component [skin/cell-text-input]}\r\n\r\n          {:id (continous-number)\r\n           :indicators #{}\r\n           :data :hostname\r\n           :component [skin/map-key]}\r\n          {:id (continous-number)\r\n           :indicators #{}\r\n           :data (:hostname data)\r\n           :component [skin/cell-text-input]}\r\n\r\n          {:id (continous-number)\r\n           :indicators #{}\r\n           :data :location\r\n           :component [skin/map-key]}\r\n          {:id (continous-number)\r\n           :indicators #{}\r\n           :data #{\"Haifa\"}\r\n           :component [(skin/multi-select-menu-init [\"PTK\" \"JER\"]) ]}\r\n          {:id (continous-number)\r\n           :indicators #{}\r\n           :data :single-location\r\n           :component [skin/map-key]}\r\n          {:id (continous-number)\r\n           :indicators #{}\r\n           :data #{\"Haifa\"}\r\n           :component [(skin/single-select-menu-init [\"PTK\" \"JER\"]) ]}\r\n\r\n\r\n          {:id (continous-number)\r\n           :indicators #{:expanded}\r\n           :data :DUTs\r\n           :component [skin/map-key]}\r\n          {:id (continous-number)\r\n           :indicators #{:expanded}\r\n           :data (mapv (fn [dut]\r\n                         {:id (str (random-uuid))\r\n                          :indicators #{:expanded}\r\n                          :data {{:id (str (random-uuid))\r\n                                  :indicators #{}\r\n                                  :data :name\r\n                                  :component [skin/map-key]}\r\n\r\n                                 {:id (str (random-uuid))\r\n                                  :indicators #{}\r\n                                  :data (:name dut)\r\n                                  :component [skin/cell-text-input ]}}\r\n                          :component []}) (:duts data))\r\n           :component []}}})\r\n"]}